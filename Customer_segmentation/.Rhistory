############################# LIBRARY IMPORTS  #############################
library(FactoMineR)
library(factoextra)
library(Factoshiny)
library(datasets)
library(stats)
library(discoveR)
library(RODBC)
library(corrplot)
library(fpc) #cluster boot
library(doBy)
library(xlsx)
library(plyr)
library(dplyr)
library(data.table) # data handling
library(jsonlite)
library(factoextra) # PCA
library(corrplot) # correlation plot
library(readr)
library(kohonen) # SOM
library(cluster) # PAM / CLARA
library(FactoMineR) # PCA
library(ClustOfVar)
library(PCAmixdata)
library(StatMatch)
library(corrplot)
library(Factoshiny)
library(scorecard)
library(ClusterR)
library(dplyr)
library(ggplot2)
library(Rmixmod)
library(dbscan)
library(fpc)
library(mclust)
library(dendextend)
library(magrittr)
library(tidyr)
library(clustree)
library(rpud)
library(msm)
size = 10000
SUBSCRIBER_ID <- sample(1:size)
SENIORITY_NETFLIX <- round(runif(n = size, min = 1 , max = 1500 ))
SENIORITY_IN_TC <- list()
for (el in SENIORITY_NETFLIX) {
SENIORITY_IN_TC <- append(SENIORITY_IN_TC , el - round(runif(n = 1, min = 1 , max = el )* 0.5))
}
RECENCY_IN_TC <- list()
for (el in SENIORITY_IN_TC) {
RECENCY_IN_TC <- append(RECENCY_IN_TC, round(runif(n = 1, min = 1 , max = el )))
}
NB_TC_WATCHED <- round((as.numeric(SENIORITY_IN_TC) - as.numeric(RECENCY_IN_TC))* abs(rnorm(size))/10 ) + 1
NB_DAYS_WATCH_TC <- round(NB_TC_WATCHED * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_CUMULATED_HOURS <- round(NB_TC_WATCHED*2 + NB_TC_WATCHED*rnorm(size))
AVG_TC_NB_DAYS_FROM_LAUNCHED <- round(rtnorm(size, mean = 50 ,sd = 80, lower=1))
MIN_TC_NB_DAYS_FROM_LAUNCHED <- round(AVG_TC_NB_DAYS_FROM_LAUNCHED - AVG_TC_NB_DAYS_FROM_LAUNCHED* rtnorm(10000, mean=0, sd= 0.25, lower=0, upper=1) + 1)
MAX_TC_NB_DAYS_FROM_LAUNCHED <- round(AVG_TC_NB_DAYS_FROM_LAUNCHED + AVG_TC_NB_DAYS_FROM_LAUNCHED* rtnorm(10000, mean=0, sd= 0.25, lower=0, upper=1))
MAX_TC_NB_DAYS_FROM_LAUNCHED
size = 10000
SUBSCRIBER_ID <- sample(1:size)
SENIORITY_PLATFORM <- round(runif(n = size, min = 1 , max = 1500 ))
SENIORITY_IN_TC <- list()
for (el in SENIORITY_PLATFORM) {
SENIORITY_IN_TC <- append(SENIORITY_IN_TC , el - round(runif(n = 1, min = 1 , max = el )* 0.5))
}
RECENCY_IN_TC <- list()
for (el in SENIORITY_IN_TC) {
RECENCY_IN_TC <- append(RECENCY_IN_TC, round(runif(n = 1, min = 1 , max = el )))
}
NB_TC_WATCHED <- round((as.numeric(SENIORITY_IN_TC) - as.numeric(RECENCY_IN_TC))* abs(rnorm(size))/10 ) + 1
NB_DAYS_WATCH_TC <- round(NB_TC_WATCHED * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_CUMULATED_HOURS <- round(NB_TC_WATCHED*2 + NB_TC_WATCHED*rnorm(size))
AVG_TC_NB_DAYS_FROM_LAUNCHED <- round(rtnorm(size, mean = 50 ,sd = 80, lower=1))
MIN_TC_NB_DAYS_FROM_LAUNCHED <- round(AVG_TC_NB_DAYS_FROM_LAUNCHED - AVG_TC_NB_DAYS_FROM_LAUNCHED* rtnorm(10000, mean=0, sd= 0.25, lower=0, upper=1) + 1)
MAX_TC_NB_DAYS_FROM_LAUNCHED <- round(AVG_TC_NB_DAYS_FROM_LAUNCHED + AVG_TC_NB_DAYS_FROM_LAUNCHED* rtnorm(10000, mean=0, sd= 0.25, lower=0, upper=1))
MAX_TC_NB_DAYS_FROM_LAUNCHED
hist(rtnorm(10000, mean = 50 ,sd = 80, lower=1))
rtnorm(size, 1, lower=0.7, upper=2.2))
rtnorm(size, 1, lower=0.7, upper=2.2)
hist(rtnorm(10000, mean = 50 ,sd = 80, lower=1))
hist(rtnorm(10000, mean = 50 ,sd = 30, lower=1))
hist(rtnorm(10000, mean = 40 ,sd = 30, lower=1))
hist(rtnorm(10000, mean = 40 ,sd = 50, lower=1))
hist(rtnorm(10000, mean = 40 ,sd = 50, lower=1))
hist(rtnorm(10000, mean = 40 ,sd = 40, lower=1))
NB_TC_WATCHED
rtnorm(size, mean = 40 ,sd = 40, lower=1)
NB_MOVIES <- NB_TC_WATCHED + round(rtnorm(size, mean = 40 ,sd = 40, lower=1))
NB_MOVIES
length(NB_MOVIES)
runif(n = size, min = 1 , max = 1500 )
round(runif(n = size, min = 1 , max = 10 ))
size = 10000
SUBSCRIBER_ID <- sample(1:size)
SENIORITY_PLATFORM <- round(runif(n = size, min = 1 , max = 1500 ))
SENIORITY_IN_TC <- list()
for (el in SENIORITY_PLATFORM) {
SENIORITY_IN_TC <- append(SENIORITY_IN_TC , el - round(runif(n = 1, min = 1 , max = el )* 0.5))
}
RECENCY_IN_TC <- list()
for (el in SENIORITY_IN_TC) {
RECENCY_IN_TC <- append(RECENCY_IN_TC, round(runif(n = 1, min = 1 , max = el )))
}
NB_TC_WATCHED <- round((as.numeric(SENIORITY_IN_TC) - as.numeric(RECENCY_IN_TC))* abs(rnorm(size))/10 ) + 1
NB_DAYS_WATCH_TC <- round(NB_TC_WATCHED * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_CUMULATED_HOURS <- round(NB_TC_WATCHED*2 + NB_TC_WATCHED*rnorm(size))
AVG_TC_NB_DAYS_FROM_LAUNCHED <- round(rtnorm(size, mean = 50 ,sd = 80, lower=1))
MIN_TC_NB_DAYS_FROM_LAUNCHED <- round(AVG_TC_NB_DAYS_FROM_LAUNCHED - AVG_TC_NB_DAYS_FROM_LAUNCHED* rtnorm(10000, mean=0, sd= 0.25, lower=0, upper=1) + 1)
MAX_TC_NB_DAYS_FROM_LAUNCHED <- round(AVG_TC_NB_DAYS_FROM_LAUNCHED + AVG_TC_NB_DAYS_FROM_LAUNCHED* rtnorm(10000, mean=0, sd= 0.25, lower=0, upper=1))
NB_MOVIES <- NB_TC_WATCHED + round(rtnorm(size, mean = 40 ,sd = 40, lower=1))
NB_GENRE <- NB_MOVIES / round(runif(n = size, min = 1 , max = 10 ))
NB_HOURS <- round(NB_MOVIES*2 + NB_MOVIES*rnorm(size))
NB_DAYS_WATCH_ALL <- round(NB_MOVIES * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_ALL_HOUR_RATIO <- TC_CUMULATED_HOURS/NB_HOURS
TC_ALL_HOUR_RATIO
min(rtnorm(size, mean = 40 ,sd = 40, lower=1))
rnorm(size)
TC_CUMULATED_HOURS
NB_HOURS
TC_CUMULATED_HOURS
min(TC_CUMULATED_HOURS)
min(NB_DAYS_WATCH_TC)
min(NB_TC_WATCHED)
rnorm(size)
NB_TC_WATCHED*2
NB_TC_WATCHED*rnorm(size)
min(NB_TC_WATCHED*rnorm(size))
NB_TC_WATCHED
rnorm(size)
hist(rnorm(size))
x <- rnorm(size)
x
rtnorm(size, lower=0, upper=1)
hist(rtnorm(size, lower=0, upper=1))
hist(rtnorm(size, lower=0, upper=1, mean=0.5))
hist(rtnorm(size, lower=0, upper=1, mean=0.5, sd=0.2))
hist(rtnorm(size, lower=0, upper=1, mean=0, sd=0.2))
hist(rtnorm(size, lower=0, upper=1, mean=0, sd=0.3))
hist(rtnorm(size, lower=0, upper=1, mean=0, sd=0.2))
hist(rtnorm(size, lower=0, upper=1, mean=0, sd=0.4))
hist(rtnorm(size, lower=0, upper=1, mean=0, sd=0.3))
size = 10000
SUBSCRIBER_ID <- sample(1:size)
SENIORITY_PLATFORM <- round(runif(n = size, min = 1 , max = 1500 ))
SENIORITY_IN_TC <- list()
for (el in SENIORITY_PLATFORM) {
SENIORITY_IN_TC <- append(SENIORITY_IN_TC , el - round(runif(n = 1, min = 1 , max = el )* 0.5))
}
RECENCY_IN_TC <- list()
for (el in SENIORITY_IN_TC) {
RECENCY_IN_TC <- append(RECENCY_IN_TC, round(runif(n = 1, min = 1 , max = el )))
}
NB_TC_WATCHED <- round((as.numeric(SENIORITY_IN_TC) - as.numeric(RECENCY_IN_TC))* abs(rnorm(size))/10 ) + 1
NB_DAYS_WATCH_TC <- round(NB_TC_WATCHED * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_CUMULATED_HOURS <- round(NB_TC_WATCHED*2 + NB_TC_WATCHED* rtnorm(size, lower=0, upper=1, mean=0, sd=0.3))
TC_CUMULATED_HOURS
min(TC_CUMULATED_HOURS)
hist(rtnorm(size, lower=0, upper=1, mean=0, sd=0.3))
hist(rtnorm(size, lower=-1, upper=1, mean=0, sd=0.3))
hist(rtnorm(size, lower=-1, upper=1, mean=0, sd=0.3))
hist(rtnorm(size, lower=-1, upper=1, mean=0, sd=0.2))
hist(rtnorm(size, lower=-1, upper=1, mean=0, sd=0.3))
NB_TC_WATCHED <- round((as.numeric(SENIORITY_IN_TC) - as.numeric(RECENCY_IN_TC))* abs(rnorm(size))/10 ) + 1
NB_DAYS_WATCH_TC <- round(NB_TC_WATCHED * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_CUMULATED_HOURS <- round(NB_TC_WATCHED*2 + NB_TC_WATCHED* rtnorm(size, lower=-1, upper=1, mean=0, sd=0.3))
min(TC_CUMULATED_HOURS)
NB_MOVIES <- NB_TC_WATCHED + round(rtnorm(size, mean = 40 ,sd = 40, lower=1))
NB_GENRE <- NB_MOVIES / round(runif(n = size, min = 1 , max = 10 ))
NB_HOURS <- round(NB_MOVIES*2 + NB_MOVIES*rnorm(size))
NB_DAYS_WATCH_ALL <- round(NB_MOVIES * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_ALL_HOUR_RATIO <- TC_CUMULATED_HOURS/NB_HOURS
NB_MOVIES
min(NB_MOVIES)
max(NB_MOVIES)
hist(NB_GENRE)
min(NB_GENRE)
MIN(TC_ALL_HOUR_RATIO)
min(TC_ALL_HOUR_RATIO)
TC_ALL_HOUR_RATIO <- TC_CUMULATED_HOURS/NB_HOURS
min(TC_ALL_HOUR_RATIO)
NB_HOURS <- round(NB_MOVIES*2 + NB_MOVIES * rtnorm(size, lower=-1, upper=1, mean=0, sd=0.3))
NB_DAYS_WATCH_ALL <- round(NB_MOVIES * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_ALL_HOUR_RATIO <- TC_CUMULATED_HOURS/NB_HOURS
min(TC_ALL_HOUR_RATIO)
hist(TC_ALL_HOUR_RATIO)
min(round(rtnorm(size, mean = 40 ,sd = 40, lower=1)))
min(TC_ALL_HOUR_RATIO)
max(TC_ALL_HOUR_RATIO)
############################# Data Simulation #################################
size = 10000
SUBSCRIBER_ID <- sample(1:size)
SENIORITY_PLATFORM <- round(runif(n = size, min = 1 , max = 1500 ))
SENIORITY_IN_TC <- list()
for (el in SENIORITY_PLATFORM) {
SENIORITY_IN_TC <- append(SENIORITY_IN_TC , el - round(runif(n = 1, min = 1 , max = el )* 0.5))
}
RECENCY_IN_TC <- list()
for (el in SENIORITY_IN_TC) {
RECENCY_IN_TC <- append(RECENCY_IN_TC, round(runif(n = 1, min = 1 , max = el )))
}
NB_TC_WATCHED <- round((as.numeric(SENIORITY_IN_TC) - as.numeric(RECENCY_IN_TC))* abs(rnorm(size))/10 ) + 1
NB_DAYS_WATCH_TC <- round(NB_TC_WATCHED * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_CUMULATED_HOURS <- round(NB_TC_WATCHED*2 + NB_TC_WATCHED* rtnorm(size, lower=-1, upper=1, mean=0, sd=0.3))
AVG_TC_NB_DAYS_FROM_LAUNCHED <- round(rtnorm(size, mean = 50 ,sd = 80, lower=1))
MIN_TC_NB_DAYS_FROM_LAUNCHED <- round(AVG_TC_NB_DAYS_FROM_LAUNCHED - AVG_TC_NB_DAYS_FROM_LAUNCHED* rtnorm(10000, mean=0, sd= 0.25, lower=0, upper=1) + 1)
MAX_TC_NB_DAYS_FROM_LAUNCHED <- round(AVG_TC_NB_DAYS_FROM_LAUNCHED + AVG_TC_NB_DAYS_FROM_LAUNCHED* rtnorm(10000, mean=0, sd= 0.25, lower=0, upper=1))
NB_MOVIES <- NB_TC_WATCHED + round(rtnorm(size, mean = 40 ,sd = 40, lower=1))
NB_GENRE <- NB_MOVIES / runif(n = size, min = 1 , max = 10 )
NB_HOURS <- round(NB_MOVIES*2.5 + NB_MOVIES * rtnorm(size, lower=-1, upper=1, mean=0, sd=0.3))
NB_DAYS_WATCH_ALL <- round(NB_MOVIES * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_ALL_HOUR_RATIO <- TC_CUMULATED_HOURS/NB_HOURS
max(TC_ALL_HOUR_RATIO)
size = 10000
SUBSCRIBER_ID <- sample(1:size)
SENIORITY_PLATFORM <- round(runif(n = size, min = 1 , max = 1500 ))
SENIORITY_IN_TC <- list()
for (el in SENIORITY_PLATFORM) {
SENIORITY_IN_TC <- append(SENIORITY_IN_TC , el - round(runif(n = 1, min = 1 , max = el )* 0.5))
}
RECENCY_IN_TC <- list()
for (el in SENIORITY_IN_TC) {
RECENCY_IN_TC <- append(RECENCY_IN_TC, round(runif(n = 1, min = 1 , max = el )))
}
NB_TC_WATCHED <- round((as.numeric(SENIORITY_IN_TC) - as.numeric(RECENCY_IN_TC))* abs(rnorm(size))/10 ) + 1
NB_DAYS_WATCH_TC <- round(NB_TC_WATCHED * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_CUMULATED_HOURS <- round(NB_TC_WATCHED*2 + NB_TC_WATCHED* rtnorm(size, lower=-1, upper=1, mean=0, sd=0.3))
AVG_TC_NB_DAYS_FROM_LAUNCHED <- round(rtnorm(size, mean = 50 ,sd = 80, lower=1))
MIN_TC_NB_DAYS_FROM_LAUNCHED <- round(AVG_TC_NB_DAYS_FROM_LAUNCHED - AVG_TC_NB_DAYS_FROM_LAUNCHED* rtnorm(10000, mean=0, sd= 0.25, lower=0, upper=1) + 1)
MAX_TC_NB_DAYS_FROM_LAUNCHED <- round(AVG_TC_NB_DAYS_FROM_LAUNCHED + AVG_TC_NB_DAYS_FROM_LAUNCHED* rtnorm(10000, mean=0, sd= 0.25, lower=0, upper=1))
NB_MOVIES <- NB_TC_WATCHED + round(rtnorm(size, mean = 40 ,sd = 40, lower=1))
NB_GENRE <- NB_MOVIES / runif(n = size, min = 1 , max = 10 )
NB_HOURS <- round(NB_MOVIES*2.5 + NB_MOVIES * rtnorm(size, lower=-1, upper=1, mean=0, sd=0.3))
NB_DAYS_WATCH_ALL <- round(NB_MOVIES * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_ALL_HOUR_RATIO <- TC_CUMULATED_HOURS/NB_HOURS
TC_ALL_HOUR_RATIO_LAST_6_MONTHS <- TC_ALL_HOUR_RATIO + TC_ALL_HOUR_RATIO*rtnorm(size, lower=-1, upper=1, mean=0, sd=0.2)
data <- cbind(SUBSCRIBER_ID, SENIORITY_PLATFORM, SENIORITY_IN_TC, RECENCY_IN_TC,
NB_TC_WATCHED, NB_DAYS_WATCH_TC, TC_CUMULATED_HOURS, AVG_TC_NB_DAYS_FROM_LAUNCHED,
MIN_TC_NB_DAYS_FROM_LAUNCHED, MAX_TC_NB_DAYS_FROM_LAUNCHED, NB_MOVIES,
NB_GENRE, NB_HOURS, NB_DAYS_WATCH_ALL, TC_ALL_HOUR_RATIO, TC_ALL_HOUR_RATIO_LAST_6_MONTHS)
head(data)
head(data[-1])
head(data)
data[-1]
is.na(Dataset_Clustering)
Dataset_Clustering = data
Dataset_Clustering[is.na(Dataset_Clustering)] <- 0
is.na(Dataset_Clustering)
sum(is.na(Dataset_Clustering))
data
head(data)
Dataset_Clustering[-c(1)]
data[,-1]
head(data[,-1])
summary(data)
PCA_output = prcomp(Dataset_Clustering[,-1], scale = TRUE)
Dataset_Clustering[,-1]
sum(is.na(Dataset_Clustering))
prcomp(Dataset_Clustering[,-1], scale = TRUE)
summary(data)
PCA_output = prcomp(Dataset_Clustering[,-1], scale = TRUE)
View(data)
View(data)
size = 10000
SUBSCRIBER_ID <- sample(1:size)
SENIORITY_PLATFORM <- round(runif(n = size, min = 1 , max = 1500 ))
SENIORITY_IN_TC <- list()
for (el in SENIORITY_PLATFORM) {
SENIORITY_IN_TC <- append(SENIORITY_IN_TC , el - round(runif(n = 1, min = 1 , max = el )* 0.5))
}
RECENCY_IN_TC <- list()
for (el in SENIORITY_IN_TC) {
RECENCY_IN_TC <- append(RECENCY_IN_TC, round(runif(n = 1, min = 1 , max = el )))
}
NB_TC_WATCHED <- round((as.numeric(SENIORITY_IN_TC) - as.numeric(RECENCY_IN_TC))* abs(rnorm(size))/10 ) + 1
NB_DAYS_WATCH_TC <- round(NB_TC_WATCHED * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_CUMULATED_HOURS <- round(NB_TC_WATCHED*2 + NB_TC_WATCHED* rtnorm(size, lower=-1, upper=1, mean=0, sd=0.3))
AVG_TC_NB_DAYS_FROM_LAUNCHED <- round(rtnorm(size, mean = 50 ,sd = 80, lower=1))
MIN_TC_NB_DAYS_FROM_LAUNCHED <- round(AVG_TC_NB_DAYS_FROM_LAUNCHED - AVG_TC_NB_DAYS_FROM_LAUNCHED* rtnorm(10000, mean=0, sd= 0.25, lower=0, upper=1) + 1)
MAX_TC_NB_DAYS_FROM_LAUNCHED <- round(AVG_TC_NB_DAYS_FROM_LAUNCHED + AVG_TC_NB_DAYS_FROM_LAUNCHED* rtnorm(10000, mean=0, sd= 0.25, lower=0, upper=1))
NB_MOVIES <- NB_TC_WATCHED + round(rtnorm(size, mean = 40 ,sd = 40, lower=1))
NB_GENRE <- round(NB_MOVIES / runif(n = size, min = 1 , max = 10 ))
NB_HOURS <- round(NB_MOVIES*2.5 + NB_MOVIES * rtnorm(size, lower=-1, upper=1, mean=0, sd=0.3))
NB_DAYS_WATCH_ALL <- round(NB_MOVIES * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_ALL_HOUR_RATIO <- TC_CUMULATED_HOURS/NB_HOURS
TC_ALL_HOUR_RATIO_LAST_6_MONTHS <- TC_ALL_HOUR_RATIO + TC_ALL_HOUR_RATIO*rtnorm(size, lower=-1, upper=1, mean=0, sd=0.2)
data <- cbind(SUBSCRIBER_ID, SENIORITY_PLATFORM, SENIORITY_IN_TC, RECENCY_IN_TC,
NB_TC_WATCHED, NB_DAYS_WATCH_TC, TC_CUMULATED_HOURS, AVG_TC_NB_DAYS_FROM_LAUNCHED,
MIN_TC_NB_DAYS_FROM_LAUNCHED, MAX_TC_NB_DAYS_FROM_LAUNCHED, NB_MOVIES,
NB_GENRE, NB_HOURS, NB_DAYS_WATCH_ALL, TC_ALL_HOUR_RATIO, TC_ALL_HOUR_RATIO_LAST_6_MONTHS)
View(data)
View(data)
data
PCA_output = prcomp(data[,-1], scale = TRUE)
is.numeric(data)
is.numeric(data[,-1])
gc()
is.numeric(data[,1])
data[,1]
data[1]
data[,1]
is.numeric(data)
data <- data.frame(SUBSCRIBER_ID, SENIORITY_PLATFORM, SENIORITY_IN_TC, RECENCY_IN_TC,
NB_TC_WATCHED, NB_DAYS_WATCH_TC, TC_CUMULATED_HOURS, AVG_TC_NB_DAYS_FROM_LAUNCHED,
MIN_TC_NB_DAYS_FROM_LAUNCHED, MAX_TC_NB_DAYS_FROM_LAUNCHED, NB_MOVIES,
NB_GENRE, NB_HOURS, NB_DAYS_WATCH_ALL, TC_ALL_HOUR_RATIO, TC_ALL_HOUR_RATIO_LAST_6_MONTHS)
head(data)
gc()
summary(data)
gc()
is.na(data$SUBSCRIBER_ID)
sum(is.na(data$SUBSCRIBER_ID))
data <- cbind(SUBSCRIBER_ID, SENIORITY_PLATFORM, SENIORITY_IN_TC, RECENCY_IN_TC,
NB_TC_WATCHED, NB_DAYS_WATCH_TC, TC_CUMULATED_HOURS, AVG_TC_NB_DAYS_FROM_LAUNCHED,
MIN_TC_NB_DAYS_FROM_LAUNCHED, MAX_TC_NB_DAYS_FROM_LAUNCHED, NB_MOVIES,
NB_GENRE, NB_HOURS, NB_DAYS_WATCH_ALL, TC_ALL_HOUR_RATIO, TC_ALL_HOUR_RATIO_LAST_6_MONTHS)
PCA_output = prcomp(data, scale = TRUE)
sum(is.na(SUBSCRIBER_ID))
sum(is.na(SENIORITY_PLATFORM))
sum(is.na(SENIORITY_IN_TC))
sum(is.numeric(SENIORITY_IN_TC))
sum(is.numeric(SUBSCRIBER_ID))
sum(is.numeric(SENIORITY_PLATFORM))
is.numeric(SENIORITY_PLATFORM)
is.numeric(SENIORITY_IN_TC)
is.numeric(RECENCY_IN_TC)
is.numeric(RECENCY_IN_TC)
SENIORITY_IN_TC
as.numeric(SENIORITY_IN_TC)
SUBSCRIBER_ID <- sample(1:size)
SENIORITY_PLATFORM <- round(runif(n = size, min = 1 , max = 1500 ))
SENIORITY_IN_TC <- list()
for (el in SENIORITY_PLATFORM) {
SENIORITY_IN_TC <- append(SENIORITY_IN_TC , el - round(runif(n = 1, min = 1 , max = el )* 0.5))
}
SENIORITY_IN_TC <- as.numeric(SENIORITY_IN_TC)
RECENCY_IN_TC <- list()
for (el in SENIORITY_IN_TC) {
RECENCY_IN_TC <- append(RECENCY_IN_TC, round(runif(n = 1, min = 1 , max = el )))
}
RECENCY_IN_TC <- as.numeric(RECENCY_IN_TC)
as.numeric(SENIORITY_IN_TC)
is.numeric(RECENCY_IN_TC)
is.numeric(NB_TC_WATCHED)
size = 10000
SUBSCRIBER_ID <- sample(1:size)
SENIORITY_PLATFORM <- round(runif(n = size, min = 1 , max = 1500 ))
SENIORITY_IN_TC <- list()
for (el in SENIORITY_PLATFORM) {
SENIORITY_IN_TC <- append(SENIORITY_IN_TC , el - round(runif(n = 1, min = 1 , max = el )* 0.5))
}
SENIORITY_IN_TC <- as.numeric(SENIORITY_IN_TC)
RECENCY_IN_TC <- list()
for (el in SENIORITY_IN_TC) {
RECENCY_IN_TC <- append(RECENCY_IN_TC, round(runif(n = 1, min = 1 , max = el )))
}
RECENCY_IN_TC <- as.numeric(RECENCY_IN_TC)
NB_TC_WATCHED <- round((as.numeric(SENIORITY_IN_TC) - as.numeric(RECENCY_IN_TC))* abs(rnorm(size))/10 ) + 1
is.numeric(NB_TC_WATCHED)
NB_DAYS_WATCH_TC <- round(NB_TC_WATCHED * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_CUMULATED_HOURS <- round(NB_TC_WATCHED*2 + NB_TC_WATCHED* rtnorm(size, lower=-1, upper=1, mean=0, sd=0.3))
AVG_TC_NB_DAYS_FROM_LAUNCHED <- round(rtnorm(size, mean = 50 ,sd = 80, lower=1))
MIN_TC_NB_DAYS_FROM_LAUNCHED <- round(AVG_TC_NB_DAYS_FROM_LAUNCHED - AVG_TC_NB_DAYS_FROM_LAUNCHED* rtnorm(10000, mean=0, sd= 0.25, lower=0, upper=1) + 1)
MAX_TC_NB_DAYS_FROM_LAUNCHED <- round(AVG_TC_NB_DAYS_FROM_LAUNCHED + AVG_TC_NB_DAYS_FROM_LAUNCHED* rtnorm(10000, mean=0, sd= 0.25, lower=0, upper=1))
NB_MOVIES <- NB_TC_WATCHED + round(rtnorm(size, mean = 40 ,sd = 40, lower=1))
NB_GENRE <- round(NB_MOVIES / runif(n = size, min = 1 , max = 10 ))
NB_HOURS <- round(NB_MOVIES*2.5 + NB_MOVIES * rtnorm(size, lower=-1, upper=1, mean=0, sd=0.3))
NB_DAYS_WATCH_ALL <- round(NB_MOVIES * rtnorm(size, 1, lower=0.7, upper=2.2))
TC_ALL_HOUR_RATIO <- TC_CUMULATED_HOURS/NB_HOURS
TC_ALL_HOUR_RATIO_LAST_6_MONTHS <- TC_ALL_HOUR_RATIO + TC_ALL_HOUR_RATIO*rtnorm(size, lower=-1, upper=1, mean=0, sd=0.2)
is.numeric(NB_TC_WATCHED)
is.numeric(NB_DAYS_WATCH_TC)
is.numeric(TC_CUMULATED_HOURS)
data <- cbind(SUBSCRIBER_ID, SENIORITY_PLATFORM, SENIORITY_IN_TC, RECENCY_IN_TC,
NB_TC_WATCHED, NB_DAYS_WATCH_TC, TC_CUMULATED_HOURS, AVG_TC_NB_DAYS_FROM_LAUNCHED,
MIN_TC_NB_DAYS_FROM_LAUNCHED, MAX_TC_NB_DAYS_FROM_LAUNCHED, NB_MOVIES,
NB_GENRE, NB_HOURS, NB_DAYS_WATCH_ALL, TC_ALL_HOUR_RATIO, TC_ALL_HOUR_RATIO_LAST_6_MONTHS)
PCA_output = prcomp(data[,-1], scale = TRUE)
data <- cbind(SUBSCRIBER_ID, SENIORITY_PLATFORM, SENIORITY_IN_TC, RECENCY_IN_TC,
NB_TC_WATCHED, NB_DAYS_WATCH_TC, TC_CUMULATED_HOURS, AVG_TC_NB_DAYS_FROM_LAUNCHED,
MIN_TC_NB_DAYS_FROM_LAUNCHED, MAX_TC_NB_DAYS_FROM_LAUNCHED, NB_MOVIES,
NB_GENRE, NB_HOURS, NB_DAYS_WATCH_ALL, TC_ALL_HOUR_RATIO, TC_ALL_HOUR_RATIO_LAST_6_MONTHS)
############################# Cleaning check ###################
head(data)
PCA_output = prcomp(data[,-1], scale = TRUE)
# Choose nb of axis depending on cumulative variance explained and axis contribution
summary(PCA_output)
plot(PCA_output)
fviz_eig(PCA_output)
get_eigenvalue(PCA_output)
fviz_pca_var(PCA_output,
col.var = "contrib", # Color by contributions to the PC
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE     # Avoid text overlapping
)
fviz_pca_var(PCA_output,
col.var = "contrib",
repel = TRUE, axes=c(1, 2))
fviz_pca_var(PCA_output,
col.var = "contrib", # Color by contributions to the PC
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE     # Avoid text overlapping
)
hist(rtnorm(size, lower=-1, upper=1, mean=0, sd=0.3))
hist(rtnorm(size, lower=-1, upper=1))
rtnorm(size, lower=-1, upper=1)
hist(rtnorm(size, lower=-1, upper=1))
hist(rtnorm(size, lower=-1, upper=1))
